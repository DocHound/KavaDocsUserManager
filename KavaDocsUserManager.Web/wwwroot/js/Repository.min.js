var vm={},app;vm={repository:{},newUser:{awesomplete:null,username:"",userType:"contributor",visible:!1,userList:[],getName:function(n){return n.name},getUserSearchList:function(n){n.key!="ArrowDown"&&n.Key!="ArrowUp"&&n.Key!="Enter"&&(!vm.newUser.username||vm.newUser.username.length<2||ajaxJson("/api/repositories/searchusers/"+vm.newUser.username,null,function(n){console.log(n);vm.newUser.userList=n;vm.newUser.awesomplete.list=n},function(){},{method:"GET"}))}},initialize:function(){vm.repository=globals.repository;$("#Repository_Prefix").focus();toastr.options.closeButton=!0;toastr.options.positionClass="toast-bottom-right"},highlightCode:function(){$("pre code").each(function(n,t){hljs.highlightBlock(t)})},editCodeField:function(n,t){var i=$("#"+n),r=$("#"+t);r.show();r.height(i.height());i.hide()},hideCodeField:function(n,t){var i=$("#"+n),r=$("#"+t);r.hide();i.show();i.html(r.val());setTimeout(vm.highlightCode,10)},optionalFieldSelection:function(n){var r=$(n.currentTarget),i=r.val(),t;$(".optional-field-group textarea.code-editing").addClass("hidden");t=$("#"+i);console.log(t,i);t.removeClass("hidden")},addUserToRepo:function(n,t,i){ajaxJson("/api/repositories/"+n.id+"/add/"+t+"/"+i,null,function(i){n.users.push(i);vm.newUser.visible=!1;vm.newUser.username=null;toastr.success(t+" has been added to this repository")},function(n){toastr.error(n.message,"Couldn't add user")})},removeUserFromRepo:function(n,t){ajaxJson("/api/repositories/"+t.id+"/remove/"+n.id,null,function(){t.users=t.users.filter(function(t){return t.user!==n});toastr.success(n.userDisplayName+" has been removed from the repository.")},function(n){toastr.error(n.message,"Couldn't remove user")})},deleteRepository:function(){confirm("Are you sure you want to delete this repository?")&&ajaxJson("/api/repositories/"+vm.repository.id,null,function(){window.location="/repositories"},function(n){vm.status(n.message)},{method:"DELETE"})},status:function(n,t,i){n&&(t||(t="warning"),this.icon=="info"?toastr.info(this.message,i):this.icon=="success"?toastr.success(this.message,i):toastr.warning(this.message,i))}};vm.initialize();app=new Vue({el:"#RepositoryPage",data:function(){return vm}});setTimeout(function(){var n=document.getElementById("UserToAdd");vm.newUser.awesomplete=new Awesomplete(n,{list:vm.newUser.userList,selectcomplete:function(n){vm.newUser.searchname=n.text}});n.addEventListener("awesomplete-selectcomplete",function(n){var t=n.text;vm.newUser.username=t.value})},2e3);